{"state":{"content":"<h1>Templates</h1>\n<p>At the core of Perseus is its template system, which is how you'll define every page you'll ever build! However, it's important to understand a few of the nuances of this system so that you can build the best apps possible.</p>\n<h2>Templates vs Pages</h2>\n<p>In Perseus, the idea of a <em>template</em> is very different to the idea of a <em>page</em>.</p>\n<p>A <em>page</em> corresponds to a URL in your app, like the about page, the landing page, or an individual blog post.</p>\n<p>A <em>template</em> can generate <em>many</em> pages or only one by using <em>rendering strategies</em>.</p>\n<p>The best way to illustrate this is with the example of a simple blog, with each page stored in something like a CMS (content management system). This app would only need two templates (in addition to a landing page, an about page, etc.): <code>blog</code> and <code>post</code>. For simplicity, we'll put the list of all blog posts in <code>blog</code>, and then each post will have its own URL under <code>post</code>.</p>\n<p>The <code>blog</code> template will be rendered to <code>/blog</code>, and will only use the <em>build state</em> strategy, fetching a list of all our posts from the CMS every time the blog is rebuilt (or you could use revalidation and incremental generation to mean you never have to rebuild at all, but that's beyond the scope of this section). This template only generates one page, providing it the properties of the list of blog posts. So, in this case, the <code>blog</code> template has generated the <code>/blog</code> page.</p>\n<p>The <code>post</code> template is more complex, and it will generate <em>many</em> pages, one for each blog post. This would probably use the <em>build paths</em> strategy, which lets you fetch a list of blog posts from the CMS at build-time and invoke <em>build state</em> for each of them, which would then get their content, metadata, etc. Thus, the <code>post</code> template generates many pages.</p>\n<p>Hopefully that explains the difference between a template and a page. This is a somewhat unintuitive part of Perseus, but it should be clear in the documentation what the difference is. Note however that old versions of the examples in the repository used these terms interchangeably, when they used to be the same. If you see any remaining ambiguity in the docs, please <a href=\"https://github.com/framesurge/perseus/issues/new/choose\">open an issue</a>!</p>\n<h2>Defining a Template</h2>\n<p>You can define a template like so (taken from <a href=\"https://github.com/framesurge/perseus/blob/main/examples/basic/src/templates/about.rs\">the basic example</a>'s about page):</p>\n<pre><code class=\"language-rust\">use perseus::Template;\nuse sycamore::prelude::{component, view, Html, SsrNode, View};\n\n#[perseus::template(AboutPage)]\n#[component(AboutPage&lt;G&gt;)]\npub fn about_page() -&gt; View&lt;G&gt; {\n    view! {\n        p { &quot;About.&quot; }\n    }\n}\n\n#[perseus::head]\npub fn head() -&gt; View&lt;SsrNode&gt; {\n    view! {\n        title { &quot;About Page | Perseus Example â€“ Basic&quot; }\n    }\n}\n\npub fn get_template&lt;G: Html&gt;() -&gt; Template&lt;G&gt; {\n    Template::new(&quot;about&quot;).template(about_page).head(head)\n}\n\n</code></pre>\n<p>It's seen as convention in Perseus to define each template in its own file, which should expose a <code>get_template()</code> file. Note that this is just convention, and as long as you get an instance of <code>Template&lt;G&gt;</code> to the <code>define_app!</code> macro, it really doesn't matter. That said, using community conventions makes your code easier to understand and debug for others.</p>\n<p>There's a list of all the methods available on a template <a href=\"https://docs.rs/perseus/0.3/perseus/template/struct.Template.html#implementations\">here</a>, along with explanations of what they all do. Technically, you could just define a template without calling any of these, but that would just render a blank page, which would probably be useless.</p>\n<p>Also note the use of the <code>#[perseus::template(...)]</code> macro on the <code>about_page</code> function in the above example. As mentioned elsewhere in the book, this will perform some boilerplate work for you: namely deserializing your template's properties for you (if it takes any). While you don't have to use this, it makes things more convenient and there's no reason not to.</p>\n<h2>Routing</h2>\n<p>Perseus' routing system is basically invisible, there's no router that you need to work with, nor any place for you to define explicit routes. Instead, Perseus automatically infers the routes for all your templates and the pages they generate from their names!</p>\n<p>The general rule is this: a template called <code>X</code> will be rendered at <code>/X</code>. Simple. What's more difficult to understand is what we call <em>template path domains</em>, which is the system that makes route inference possible. <strong>A template can only ever generate pages within the scope of its root path.</strong> Its root path is its name. In the example of a template called <code>X</code>, it can render <code>/X/Y</code>, <code>/X/Y/Z</code>, etc., but it can <em>never</em> render <code>/A</code>.</p>\n<p>To generate paths within a template's domain, you can use the <em>build paths</em> and <em>incremental generation</em> strategies (more on those later). Both of these support dynamic parameters (which might be denoted in other languages as <code>/post/&lt;title&gt;/info</code> or the like).</p>\n<h3>Dynamic Parameters Above the Domain</h3>\n<p>One niche case is defining a route like this: <code>/&lt;locale&gt;/about</code>. In this case, the <code>about</code> template is rendered underneath a dynamic parameter. This is currently impossible in Perseus, but the most common reason to need it, internationalization (making your app work in many language), is support out-of-the-box with Perseus.</p>\n<h3>Different Templates in the Same Domain</h3>\n<p>It's perfectly possible in Perseus to define one template for <code>/post</code> (and its children) and a different one for <code>/post/new</code>. In fact, this is exactly what <a href=\"https://github.com/framesurge/perseus/tree/main/examples/showcase\">the showcase example</a> does, and you can check it out for inspiration. This is based on a simple idea: <strong>more specific templates win</strong> the routing contest.</p>\n<p>There is one use-case though that requires a bit more fiddling: having a different template for the root path. A very common use-case for this would be having one template for <code>/posts</code>'s children (one URl for each blog post) and a different template for <code>/posts</code> itself that lists all available posts. Currently, the only way to do this is to define a property on the <code>posts</code> template that will be <code>true</code> if you're rendering for that root, and then to conditionally render the list of posts. Otherwise, you would render the given post content. This does require a lot of <code>Option&lt;T&gt;</code>s, but they could be safely unwrapped (data passing in Perseus is logical and safe).</p>\n<h2>Checking Render Context</h2>\n<p>It's often necessary to make sure you're only running some logic on the client-side, particularly anything to do with <code>web_sys</code>, which will <code>panic!</code> if used on the server. Because Perseus renders your templates in both environments, you'll need to explicitly check if you want to do something only on the client (like get an authentication token from a cookie). This can be done trivially with Sycamore, just use <code>G::IS_BROWSER</code> (where <code>G</code> is the type parameter on your template). Here's an example from <a href=\"https://github.com/framesurge/perseus/blob/main/examples/i18n/src/templates/about.rs\">here</a>:</p>\n<pre><code class=\"language-rust\">use perseus::{t, Template};\nuse sycamore::prelude::{component, view, Html, View};\n\n#[perseus::template(AboutPage)]\n#[component(AboutPage&lt;G&gt;)]\npub fn about_page() -&gt; View&lt;G&gt; {\n    view! {\n        p { (t!(&quot;about&quot;)) }\n        p {\n            (\n                if !G::IS_BROWSER {\n                    &quot;This is running on the server.&quot;\n                } else {\n                    &quot;This is running on the client.&quot;\n                }\n            )\n        }\n    }\n}\n\npub fn get_template&lt;G: Html&gt;() -&gt; Template&lt;G&gt; {\n    Template::new(&quot;about&quot;).template(about_page)\n}\n\n</code></pre>\n<p>This is a very contrived example, but what you should note if you try this is the flash from <code>server</code> to <code>client</code> (when you go to the page from the URL bar, not when you go in from the link on the index page), because the page is pre-rendered on the server and then hydrated on the client. This is an important principle of Perseus, and you should be aware of this potential flashing (easily solved by a less contrived example) when your users <a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/advanced/initial-loads\">initially load</a> a page.</p>\n","current_version":"0.3.0-0.3.3","manifest":{"0.1.x":{"docs_rs":"0.1","git":"v0.1.4","state":"outdated"},"0.2.x":{"docs_rs":"0.2","git":"v0.2.3","state":"outdated"},"0.3.0-0.3.3":{"docs_rs":"0.3.3","git":"v0.3.3","state":"outdated"},"0.3.4":{"docs_rs":"0.3","git":"v0.3.6","state":"outdated"},"0.4.x":{"docs_rs":"0.4","git":"HEAD","state":"stable"}},"sidebar_content":"<h1>Introduction</h1>\n<ul>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/intro\">Introduction</a>\n<ul>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/what-is-perseus\">What is Perseus?</a></li>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/hello-world\">Hello World!</a></li>\n</ul>\n</li>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/second-app\">Your Second App</a></li>\n</ul>\n<hr />\n<h1>Reference</h1>\n<ul>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/define-app\"><code>define_app!</code></a></li>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/views\">Writing Views</a></li>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/debugging\">Debugging</a></li>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/templates/intro\">Templates and Routing</a>\n<ul>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/templates/metadata-modification\">Modifying the <code>&lt;head&gt;</code></a></li>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/templates/setting-headers\">Modifying HTTP Headers</a></li>\n</ul>\n</li>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/error-pages\">Error Pages</a></li>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/static-content\">Static Content</a></li>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/i18n/intro\">Internationalization</a>\n<ul>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/i18n/defining\">Defining Translations</a></li>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/i18n/using\">Using Translations</a></li>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/i18n/translations-managers\">Translations Managers</a></li>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/i18n/other-engines\">Other Translation Engines</a></li>\n</ul>\n</li>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/strategies/intro\">Rendering Strategies</a>\n<ul>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/strategies/build-state\">Build State</a></li>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/strategies/build-paths\">Build Paths</a></li>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/strategies/request-state\">Request State</a></li>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/strategies/revalidation\">Revalidation</a></li>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/strategies/incremental\">Incremental Generation</a></li>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/strategies/amalgamation\">State Amalgamation</a></li>\n</ul>\n</li>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/hydration\">Hydration</a></li>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/cli\">CLI</a>\n<ul>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/ejecting\">Ejecting</a></li>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/snooping\">Snooping</a></li>\n</ul>\n</li>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/testing/intro\">Testing</a>\n<ul>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/testing/checkpoints\">Checkpoints</a></li>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/testing/fantoccini-basics\">Fantoccini Basics</a></li>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/testing/manual\">Manual Testing</a></li>\n</ul>\n</li>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/styling\">Styling</a></li>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/server-communication\">Communicating with a Server</a></li>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/stores\">Stores</a></li>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/exporting\">Static Exporting</a></li>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/plugins/intro\">Plugins</a>\n<ul>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/plugins/functional\">Functional Actions</a></li>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/plugins/control\">Control Actions</a></li>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/plugins/using\">Using Plugins</a></li>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/plugins/tinker\">The <code>tinker</code> Action</a></li>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/plugins/writing\">Writing Plugins</a></li>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/plugins/security\">Security Considerations</a></li>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/plugins/publishing\">Publishing Plugins</a></li>\n</ul>\n</li>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/deploying/intro\">Deploying</a>\n<ul>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/deploying/serverful\">Server Deployment</a></li>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/deploying/serverless\">Serverless Deployment</a></li>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/deploying/size\">Optimizing Code Size</a></li>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/deploying/relative-paths\">Relative Paths</a></li>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/deploying/docker\">Docker Deployment</a></li>\n</ul>\n</li>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/updating\">Migrating from v0.2.x</a></li>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/pitfalls-and-bugs\">Common Pitfalls and Known Bugs</a></li>\n</ul>\n<hr />\n<h1>Advanced</h1>\n<ul>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/advanced/intro\">Under the Hood</a>\n<ul>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/advanced/arch\">Architecture</a></li>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/advanced/initial-loads\">Initial Loads</a></li>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/advanced/subsequent-loads\">Subsequent Loads</a></li>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/advanced/routing\">Routing</a></li>\n</ul>\n</li>\n<li><a href=\"https://framesurge.sh/perseus/en-US/docs/0.3.0-0.3.3/advanced/define_app\"><code>define_app</code> in Detail</a></li>\n</ul>\n","status":"Outdated","title":"Templates"},"head":"<title>Templates | Perseus Docs</title><link rel=stylesheet href=.perseus/static/styles/markdown.css><link rel=stylesheet href=.perseus/static/styles/docs_links_markdown.css><link rel=stylesheet href=.perseus/static/prism.css>"}