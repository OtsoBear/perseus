<!DOCTYPE html><html lang=en-US class=light><head><base href=https://framesurge.sh/perseus/><meta charset=UTF-8><meta name=viewport content="width=device-width, initial-scale=1.0"><link rel=stylesheet href=.perseus/static/tailwind.css><link rel=stylesheet href=.perseus/static/styles/style.css><script type=module>window.__PERSEUS_RENDER_CFG = `{"docs/0.3.4/reference/plugins/tinker":"docs","docs/0.1.x/strategies/incremental":"docs","docs/state/global":"docs","docs/state/revalidation":"docs","docs/0.3.0-0.3.3/advanced/arch":"docs","docs/0.3.4/reference/deploying/serverless":"docs","docs/0.3.4/reference/define-app":"docs","docs/next/state/request":"docs","docs/faq":"docs","docs/0.4.x/capsules/capsules-vs-components":"docs","docs/state/suspense":"docs","docs/0.3.4/advanced/arch":"docs","docs/0.4.x/fundamentals/compilation-times":"docs","docs/0.2.x/config-managers":"docs","docs/0.4.x/capsules/using":"docs","docs/0.1.x/config_managers":"docs","docs/0.2.x/strategies/revalidation":"docs","docs/next/intro":"docs","docs/0.3.4/reference/perseus-app":"docs","docs/0.3.0-0.3.3/define-app":"docs","docs/0.4.x/state/build":"docs","docs/0.3.0-0.3.3/i18n/translations-managers":"docs","docs/0.3.4/reference/plugins/publishing":"docs","docs/0.2.x/hello-world":"docs","docs/0.3.0-0.3.3/error-pages":"docs","docs/0.3.4/reference/hydration":"docs","docs/0.3.0-0.3.3/testing/intro":"docs","docs/next/first-app/error-handling":"docs","docs/0.2.x/testing/fantoccini-basics":"docs","docs/0.1.x/tutorials/first_app/setup":"docs","docs/state/intro":"docs","":"","docs/0.3.0-0.3.3/hydration":"docs","docs/0.1.x/setup":"docs","docs/next/first-app/installation":"docs","docs/0.3.0-0.3.3/static-content":"docs","docs/0.4.x/first-app/error-handling":"docs","docs/0.4.x/fundamentals/styling":"docs","docs/0.4.x/core-principles":"docs","docs/next/first-app/dev-cycle":"docs","docs/0.3.4/reference/strategies/build-paths":"docs","docs/0.3.4/reference/deploying/size":"docs","docs/fundamentals/serving-exporting":"docs","docs/0.4.x/capsules/intro":"docs","docs/next/state/intro":"docs","docs/0.3.4/reference/deploying/serverful":"docs","docs/0.2.x/cli":"docs","docs/first-app/generating-pages":"docs","docs/first-app/defining":"docs","docs/0.3.4/reference/state/rx":"docs","docs/0.2.x/i18n/intro":"docs","docs/0.3.0-0.3.3/deploying/size":"docs","docs/0.3.0-0.3.3/i18n/using":"docs","docs/fundamentals/debugging":"docs","docs/state/amalgamation":"docs","docs/next/state/freezing-thawing":"docs","docs/0.3.0-0.3.3/snooping":"docs","docs/0.3.4/reference/pitfalls-and-bugs":"docs","docs/fundamentals/preloading":"docs","docs/0.3.4/reference/plugins/using":"docs","docs/0.2.x/i18n/translations-managers":"docs","docs/state/freezing-thawing":"docs","docs/0.3.4/reference/strategies/intro":"docs","docs/next/fundamentals/debugging":"docs","docs/0.1.x/strategies/build_paths":"docs","docs/0.3.4/advanced/routing":"docs","docs/0.3.0-0.3.3/what-is-perseus":"docs","docs/0.4.x/fundamentals/i18n":"docs","docs/0.3.0-0.3.3/deploying/relative-paths":"docs","docs/next/fundamentals/testing":"docs","docs/0.3.0-0.3.3/deploying/docker":"docs","docs/0.3.0-0.3.3/plugins/tinker":"docs","docs/0.2.x/testing/intro":"docs","docs/0.3.4/advanced/intro":"docs","docs/0.1.x/routing":"docs","docs/0.1.x/tutorials/first_app/template":"docs","docs/next/state/incremental":"docs","docs/fundamentals/static-content":"docs","docs/0.3.4/reference/testing/checkpoints":"docs","docs/next/fundamentals/static-content":"docs","docs/fundamentals/js-interop":"docs","docs/0.3.4/reference/plugins/control":"docs","docs/0.2.x/templates/setting-headers":"docs","docs/0.3.0-0.3.3/hello-world":"docs","docs/0.3.0-0.3.3/updating":"docs","docs/capsules/capsules-vs-components":"docs","docs/0.3.4/reference/live-reloading":"docs","docs/0.2.x/updating":"docs","docs/next/fundamentals/styling":"docs","docs/next/fundamentals/plugins":"docs","docs/0.4.x/fundamentals/serving-exporting":"docs","docs/0.3.0-0.3.3/plugins/intro":"docs","docs/0.3.4/reference/strategies/build-state":"docs","docs/migrating":"docs","docs/intro":"docs","docs/0.3.0-0.3.3/plugins/publishing":"docs","docs/0.3.0-0.3.3/plugins/control":"docs","docs/0.1.x/serving":"docs","docs/0.2.x/advanced/routing":"docs","docs/state/manual":"docs","docs/0.1.x/error_pages":"docs","docs/next/state/manual":"docs","docs/fundamentals/hydration":"docs","docs/0.3.0-0.3.3/plugins/functional":"docs","docs/0.4.x/first-app/installation":"docs","docs/0.3.4/reference/stores":"docs","docs/0.3.4/reference/cli":"docs","docs/0.2.x/strategies/build-state":"docs","docs/0.2.x/what-is-perseus":"docs","docs/what-is-perseus":"docs","docs/0.1.x/strategies/build_state":"docs","docs/0.3.0-0.3.3/strategies/incremental":"docs","docs/next/capsules/capsules-vs-components":"docs","docs/0.3.0-0.3.3/i18n/intro":"docs","docs/next/fundamentals/preloading":"docs","docs/0.4.x/fundamentals/error-views":"docs","docs/0.4.x/migrating":"docs","docs/0.3.4/reference/engines":"docs","docs/0.4.x/state/manual":"docs","docs/0.3.4/reference/state/global":"docs","docs/next/core-principles":"docs","docs/0.3.4/reference/snooping":"docs","docs/0.3.0-0.3.3/templates/intro":"docs","docs/0.3.0-0.3.3/views":"docs","docs/0.3.4/reference/deploying/relative-paths":"docs","docs/0.4.x/fundamentals/testing":"docs","docs/0.1.x/strategies/revalidation":"docs","docs/0.4.x/fundamentals/plugins":"docs","docs/next/fundamentals/perseus-app":"docs","docs/next/state/suspense":"docs","docs/next/capsules/using":"docs","docs/0.3.0-0.3.3/stores":"docs","docs/0.2.x/advanced/initial-loads":"docs","comparisons":"comparisons","docs/0.4.x/state/helper":"docs","docs/state/request":"docs","docs/0.3.0-0.3.3/strategies/revalidation":"docs","docs/0.3.4/intro":"docs","docs/0.3.0-0.3.3/exporting":"docs","docs/0.3.0-0.3.3/strategies/request-state":"docs","docs/0.4.x/fundamentals/debugging":"docs","docs/fundamentals/compilation-times":"docs","docs/0.3.0-0.3.3/cli":"docs","docs/0.3.4/reference/styling":"docs","docs/0.4.x/state/incremental":"docs","docs/0.3.0-0.3.3/templates/metadata-modification":"docs","docs/0.2.x/advanced/intro":"docs","docs/0.4.x/fundamentals/head-headers":"docs","docs/0.4.x/quickstart":"docs","docs/0.3.4/reference/testing/manual":"docs","docs/0.3.0-0.3.3/server-communication":"docs","docs/state/incremental":"docs","docs/0.4.x/fundamentals/perseus-app":"docs","docs/first-app/installation":"docs","docs/0.2.x/views":"docs","docs/0.3.0-0.3.3/deploying/intro":"docs","docs/0.2.x/i18n/defining":"docs","docs/0.4.x/first-app/deploying":"docs","docs/0.3.4/reference/state/idb-freezing":"docs","docs/core-principles":"docs","docs/0.3.4/reference/plugins/functional":"docs","docs/0.4.x/state/revalidation":"docs","docs/0.4.x/intro":"docs","docs/0.3.0-0.3.3/advanced/subsequent-loads":"docs","docs/0.3.4/reference/i18n/defining":"docs","docs/0.3.4/reference/state/hsr":"docs","docs/0.2.x/advanced/arch":"docs","docs/0.3.4/reference/templates/metadata-modification":"docs","docs/0.1.x/strategies/intro":"docs","docs/0.3.4/reference/deploying/docker":"docs","docs/0.3.4/reference/error-pages":"docs","docs/0.4.x/faq":"docs","docs/0.3.4/reference/deploying/intro":"docs","docs/0.3.4/reference/updating":"docs","docs/next/first-app/generating-pages":"docs","docs/0.3.4/reference/strategies/request-state":"docs","docs/next/faq":"docs","docs/next/capsules/intro":"docs","docs/fundamentals/reactor":"docs","docs/0.3.0-0.3.3/strategies/build-paths":"docs","docs/0.4.x/first-app/dev-cycle":"docs","docs/0.3.0-0.3.3/deploying/serverless":"docs","docs/0.4.x/fundamentals/hydration":"docs","docs/0.3.0-0.3.3/testing/checkpoints":"docs","docs/0.1.x/arch":"docs","docs/0.3.0-0.3.3/advanced/intro":"docs","docs/0.3.4/advanced/subsequent-loads":"docs","docs/0.2.x/static-content":"docs","docs/0.3.4/reference/i18n/using":"docs","docs/state/browser":"docs","docs/0.3.0-0.3.3/i18n/other-engines":"docs","docs/fundamentals/error-views":"docs","docs/0.2.x/intro":"docs","docs/0.2.x/strategies/incremental":"docs","docs/fundamentals/plugins":"docs","docs/next/migrating":"docs","docs/0.1.x/building":"docs","docs/0.3.4/what-is-perseus":"docs","docs/0.3.0-0.3.3/ejecting":"docs","docs/0.4.x/state/browser":"docs","docs/next/fundamentals/routing":"docs","docs/0.2.x/templates/metadata-modification":"docs","docs/0.4.x/state/freezing-thawing":"docs","docs/next/first-app/deploying":"docs","docs/capsules/using":"docs","docs/0.3.4/core-principles":"docs","docs/0.3.4/reference/views":"docs","docs/0.3.0-0.3.3/advanced/define_app":"docs","docs/0.2.x/testing/checkpoints":"docs","docs/0.3.4/reference/strategies/incremental":"docs","docs/0.3.4/advanced/initial-loads":"docs","docs/0.3.0-0.3.3/plugins/using":"docs","plugins":"plugins","docs/next/state/helper":"docs","docs/next/what-is-perseus":"docs","docs/0.2.x/error-pages":"docs","docs/0.1.x/cli":"docs","docs/0.2.x/ejecting":"docs","docs/0.2.x/i18n/using":"docs","docs/0.3.4/tutorials/hello-world":"docs","docs/0.1.x/tutorials/first_app/intro":"docs","docs/0.2.x/advanced/subsequent-loads":"docs","docs/0.2.x/strategies/build-paths":"docs","docs/0.3.0-0.3.3/strategies/build-state":"docs","docs/0.3.4/reference/i18n/intro":"docs","docs/0.2.x/strategies/amalgamation":"docs","docs/0.3.0-0.3.3/intro":"docs","docs/0.2.x/deploying/exporting":"docs","docs/fundamentals/perseus-app":"docs","docs/0.2.x/i18n/other-engines":"docs","docs/next/fundamentals/i18n":"docs","docs/0.3.4/reference/plugins/security":"docs","docs/0.4.x/fundamentals/reactor":"docs","docs/0.2.x/testing/manual":"docs","docs/0.4.x/fundamentals/js-interop":"docs","docs/0.3.4/reference/index-view":"docs","docs/0.3.4/reference/templates/router-state":"docs","docs/0.3.0-0.3.3/second-app":"docs","docs/first-app/dev-cycle":"docs","docs/next/fundamentals/compilation-times":"docs","docs/0.3.4/reference/strategies/revalidation":"docs","docs/0.3.4/tutorials/second-app":"docs","docs/next/fundamentals/serving-exporting":"docs","docs/0.3.0-0.3.3/plugins/writing":"docs","docs/next/state/browser":"docs","docs":"docs","docs/0.4.x/state/amalgamation":"docs","docs/0.3.4/reference/plugins/intro":"docs","docs/fundamentals/i18n":"docs","docs/next/fundamentals/reactor":"docs","docs/0.3.4/tutorials/auth":"docs","docs/0.3.0-0.3.3/testing/fantoccini-basics":"docs","docs/0.3.4/reference/testing/intro":"docs","docs/fundamentals/styling":"docs","docs/0.3.0-0.3.3/plugins/security":"docs","docs/0.3.0-0.3.3/testing/manual":"docs","docs/0.3.0-0.3.3/advanced/routing":"docs","docs/fundamentals/testing":"docs","docs/0.3.4/reference/testing/fantoccini-basics":"docs","docs/next/state/build":"docs","docs/0.4.x/first-app/defining":"docs","docs/0.2.x/deploying/intro":"docs","docs/first-app/deploying":"docs","docs/next/state/revalidation":"docs","docs/state/build":"docs","docs/0.2.x/define-app":"docs","docs/0.3.0-0.3.3/strategies/intro":"docs","docs/next/quickstart":"docs","docs/0.4.x/fundamentals/preloading":"docs","docs/next/fundamentals/hydration":"docs","docs/0.4.x/state/intro":"docs","docs/fundamentals/head-headers":"docs","docs/0.3.4/reference/strategies/amalgamation":"docs","docs/next/fundamentals/head-headers":"docs","docs/0.4.x/state/request":"docs","docs/0.3.4/reference/server-communication":"docs","docs/0.1.x/intro":"docs","docs/next/state/amalgamation":"docs","docs/0.2.x/debugging":"docs","docs/0.3.0-0.3.3/debugging":"docs","docs/0.2.x/styling":"docs","docs/0.3.0-0.3.3/strategies/amalgamation":"docs","docs/next/fundamentals/js-interop":"docs","docs/0.1.x/integrations/actix-web":"docs","docs/0.4.x/state/global":"docs","docs/0.3.0-0.3.3/i18n/defining":"docs","docs/next/first-app/defining":"docs","docs/0.3.4/reference/plugins/writing":"docs","docs/quickstart":"docs","docs/0.3.4/reference/ejecting":"docs","docs/first-app/error-handling":"docs","docs/0.2.x/strategies/intro":"docs","docs/fundamentals/routing":"docs","docs/0.3.0-0.3.3/advanced/initial-loads":"docs","docs/0.4.x/first-app/generating-pages":"docs","docs/0.2.x/strategies/request-state":"docs","docs/0.1.x/tutorials/first_app/app":"docs","docs/0.2.x/second-app":"docs","docs/0.4.x/fundamentals/routing":"docs","docs/next/fundamentals/error-views":"docs","docs/state/helper":"docs","docs/0.4.x/fundamentals/static-content":"docs","docs/0.3.0-0.3.3/pitfalls-and-bugs":"docs","docs/0.3.4/reference/i18n/translations-managers":"docs","docs/0.3.4/reference/exporting":"docs","docs/0.3.4/advanced/route-announcer":"docs","docs/0.4.x/what-is-perseus":"docs","docs/next/state/global":"docs","docs/0.3.0-0.3.3/deploying/serverful":"docs","docs/0.3.4/reference/debugging":"docs","docs/0.4.x/state/suspense":"docs","docs/0.2.x/templates/intro":"docs","docs/0.3.4/reference/static-content":"docs","docs/0.3.0-0.3.3/styling":"docs","docs/0.3.4/reference/templates/setting-headers":"docs","docs/0.3.0-0.3.3/templates/setting-headers":"docs","docs/0.3.4/reference/templates/intro":"docs","docs/0.3.4/reference/i18n/other-engines":"docs","docs/0.3.4/reference/state/freezing":"docs","docs/0.1.x/strategies/request_state":"docs","docs/capsules/intro":"docs","docs/0.1.x/templates":"docs"}`;

        import init from "https://framesurge.sh/perseus/.perseus/bundle.js";
        async function main() {
            await init("https://framesurge.sh/perseus/.perseus/bundle.wasm");
        }
        main();

        
        

window.__PERSEUS_GLOBAL_STATE = `null`;</script><meta itemprop=__perseus_head_boundary><title>Core Principles | Perseus Docs</title><link rel=stylesheet href=.perseus/static/styles/markdown.css><link rel=stylesheet href=.perseus/static/styles/docs_links_markdown.css><link rel=stylesheet href=.perseus/static/prism.css><script>
window.__PERSEUS_INITIAL_STATE = `{"content":"<h1>Core Principles</h1>\\n<p>Before you dive into Perseus, you might want to get a better idea of the fundamentals on which the framework is built. If you'd prefer to dive straight in though, check out <a href=\\"https://framesurge.sh/perseus/en-US/docs/next/first-app/installation\\">the tutorial</a>, and then maybe come back here later.</p>\\n<p>The main key idea that underpins Perseus is about <em>templates</em>, and the primary architectural matter to understand is how Perseus apps actually work in terms of their components.</p>\\n<h2>Templates</h2>\\n<p>Templates are the key to understanding Perseus code. Once you do, you should be able to confidently write clear code for apps that do exactly what you want them to. Nicely, this core concept also correlates with the file of code that defines the majority of the inner workings of Perseus (which is 600 lines long...).</p>\\n<p>There are two things you need to know about templates:</p>\\n<ol>\\n<li>An app is split into templates, and each template is split into pages.</li>\\n<li>A page is generated from a template and state. <strong>Template + state = page</strong></li>\\n</ol>\\n<p>Anyone who's ever used a website before will be at least passingly familiar with the idea of <em>pages</em> --- they're things that display different content, each at a different route. For example, you might have a landing page at <code>https://example.com</code> and an about page at <code>https://example.com/about</code>.</p>\\n<p>In Perseus, pages are never coded directly, they're generated by the engine from templates. Templates can be thought of as mathematical functions if you like: (crudely) a template <code>T</code> can be defined such that <code>T(x) = P</code>, where <code>x</code> is some state, and <code>P</code> is a page. </p>\\n<p>Let's take an example to understand how this works in practice. Let's say you're building a music player app that has a vast library of songs (we'll ignore playlists, artists, etc. to keep things simple). The first step in designing your app is thinking about its structure. It comes fairly quickly that you'll need an index page to show the top songs, an about page to tell people about the platform, and one page for each song. Now, the index and about pages have different structures, but every song page has the same structure, just with different content. This is where templates come in. You would have one template for the index page and another for the about page, and then you'd have a third template for the songs pages.</p>\\n<p>That third template can take in some state, and produce a different page for every single song, but all with the same structure. You can see this kind of concept in action on this very website. Every page in the docs has the same heading up the top, footer down the bottom, and sidebar on the left (or in a menu if you're on mobile), but they all have different content. There's just one template involved for all this, which generates hundreds of pages (here, that same template generates pages for every version of Perseus ever).</p>\\n<p>So what about those first two? Well, they're very simple templates that don't take any state at all --- they can only produce one page. To take our crude mathematical definition, <code>T() = P</code> for these, and, since <code>T</code> takes no arguments, it can only produce the same page every time.</p>\\n<p>This illustrates nicely that the determining factor that differentiates pages from each other is state, and that's what Perseus is built around.</p>\\n<p>Let's return to our music player app. Are all those songs listed in a database available at build-time? Use the <a href=\\"https://framesurge.sh/perseus/en-US/docs/next/state/build\\"><em>build state</em></a> strategy. Are there too many to build all at once? Use <a href=\\"https://framesurge.sh/perseus/en-US/docs/next/state/incremental\\"><em>incremental generation</em></a> to build only the most commonly used songs first, and then build the rest on-demand when they're first accessed, caching to make them fast for subsequent users.</p>\\n<p>Once that state is generated, Perseus will go right ahead and proactively prerender your pages to HTML, meaning your users see content the second they load your site. (This is called server-side rendering, except the actual rendering has happened ahead of time, whenever you built your app.)</p>\\n<p>These ideas are built into Perseus at the core, and generating state for templates to generate pages is the fundamental idea behind Perseus. You'll find similar concepts in popular JavaScript frameworks like NextJS and GatsbyJS. It's Perseus' speed, ergonomics, and some things we'll explain in a moment that set it apart.</p>\\n<p>Once you've generated some state and you've got all the pages ready, there's still a log of work to be done on this music player app. A given song might be paused or playing, the user might have manually turned off dark mode, autoplaying related songs might be on or off. This is all state, but it's not state that we can handle when we build your app. Traditionally, frameworks would leave you on your own here to work this all out, but Perseus tries to be a little more helpful by <em>automatically making your state reactive</em>. Let's say the state for a single song page includes the properties <code>name</code>, <code>artist</code>, <code>album</code>, <code>year</code>, and <code>paused</code> (there'd probably be a lot more in reality though!). The first four can be set at build time and forgotten about, but <code>paused</code> could be changed at any time. No problem, you can change it once the page is loaded. Just call <code>.set()</code> on it and Perseus will not only update it locally, but it will update it in a store global to your app so that, if a user goes back to that song later, it will be preserved (or not, your choice). And what about things like <code>dark_mode</code>, state that's relevant to the whole app? Well, Perseus provides inbuilt support for reactive global state that can be interacted with from any page.</p>\\n<p>Now, if you're familiar with user interface (UI) development, this might all sound familiar to you, it's very similar to the <em>MVC</em>, or <em>model, view, controller</em> pattern. If you've never heard of this, it's just a way of developing apps in which you hold all the states that your app can possibly be in in a <em>model</em> and use that to build a <em>view</em>. Then you handle user interaction with a <em>controller</em>, which modifies the state, and the <em>view</em> updates accordingly. Perseus doesn't force this structure on you, and in fact you can opt out entirely from all this reactive state business if it's not your cup of tea with no problems, because Perseus doesn't use MVC as a <em>pattern</em> that you develop in, it uses it as an <em>architecture</em> that your code works in. You can use development patterns from 1960 or 2060 if you want, Perseus doesn't mind, it'll just work away in the background and make sure your app's state <em>just works</em>.</p>\\n<p>Perseus also adds a little twist to the usual ideas of app state. If your entire app is represented in its state, then wouldn't it be cool if you could <em>freeze</em> that state, save it somewhere, and then boot it back up later to bring your app to exactly where it was before? This is inbuilt into Perseus, and it's still insanely fast. But, if you don't want it, you can turn it off, no problem.</p>\\n<p>THis does let you do some really cool stuff though, like bringing a user back to exactly where they left off when they log back into your app, down to the last character they typed into an input, with only a few lines of code. (You store a string, Perseus handles the freezing and thawing.)</p>\\n<h2>Architecture</h2>\\n<p>When you write a Perseus app, you'll usually just define a <code>main()</code> function annotated with <code>#[perseus::main(...)]</code>, but this does some important things in the background. Specifically, it actually creates three functions: one that returns your <code>PerseusApp</code>, and then two new <code>main()</code> functions: one for the engine, and another for the browser. That distinction is one you should get used to, because it pervades Perseus. Unfortunately, most other frameworks try to shove this away behind some abstractions, which leads to confusing dynamics about where a function should actually be run. Perseus tries to make this as clear as possible.</p>\\n<p>Before we can go any further into this though, we'll need to define the <em>engine</em>, because it's a Perseus-specific term. Usually, people would refer to the server-side, but this term was avoided for Perseus to make clear that the server is just a single part of the engine. The engine is made up of these components:</p>\\n<ul>\\n<li>Builder --- builds your app, generating some stuff in <code>dist/</code></li>\\n<li>Exporter --- goes a few steps further than the builder, structuring your app for serving as a flat file structure, with no explicit server</li>\\n<li>Server --- serves the built artifacts in <code>dist/</code>, executing certain server-side logic as necessary</li>\\n<li>Error page exporter --- exports a single error page to a static file (e.g. you'll need this if you want your custom error pages to work on GitHub Pages or similar hosts)</li>\\n<li>Tinker --- runs a certain type of plugin (more on this later)</li>\\n</ul>\\n<p>So, when we talk about <em>engine-side</em>, we mean this! The reason these are all lumped together is because they're all actually one binary, which is told what exact action to perform by a special environment variable automatically set by the CLI. So, when you run <code>perseus export</code> and <code>perseus serve</code>, those are actually <em>basically</em> both doing the exact same thing, just with a different environment variable setting!</p>\\n<p>As for the browser-side, this is just the code that runs on the <code>wasm32-unknown-unknown</code> target (yes, those <code>unknown</code>s are supposed to be there!), which is Rust's way of talking about the browser.</p>\\n<p>So, when we use the <code>#[perseus::main(...)]</code> macro, that's creating a function that returns your <code>PerseusApp</code>, and another called <code>main()</code> for the server (which is annotated with <code>#[tokio::main]</code> to make it asynchronous), and another called <code>main()</code> for the client (annotated with <code>#[wasm_bindgen::prelude::wasm_bindgen]</code> to make it discoverable by the browser).</p>\\n<p>What's nice about this architecture is that you can do it yourself without the macro! In fact, if you want to do more advanced things, like setting up custom API routes, this is the best way to go. Then, you would use the <code>#[perseus::engine_main]</code> and <code>#[perseus::browser_main]</code> annotations to make your life easier. (Or, you could avoid them and do their work yourself, which is very straightforward.)</p>\\n<p>The key thing here is that you can easily use this more advanced structure to gain greater control over your app, without sacrificing any performance. From here, you can also gain greater control over any part of your app's build process, which makes Perseus practically infinitely customizable to do exactly what you want!</p>\\n<p>The upshot of all this is that Perseus is actually creating two separate entrypoints, one for the engine-side, and another for the browser-side. Crucially, both use the same <code>PerseusApp</code>, which is a universal way of defining your app's components, like templates. (You don't need to know this, but it actually does slightly different things on the browser and engine-sides itself to optimize your app.)</p>\\n<p>Why do you need to know all this? Because it makes it much easier to understand how to expand your app's capabilities, and it demystifies those macros a bit. Also, it shows that you can actually avoid them entirely if you want to! (Sycamore also has a <a href=\\"https://sycamore-rs.netlify.app/docs/basics/view#builder-syntax\\">builder API</a> that you can use to avoid their <code>view! { .. }</code> macro too, if you really want.)</p>\\n<p>One more thing to briefly note is about the <code>dist/target_wasm/</code> and <code>dist/target_engine/</code> directories. As you might have inferred, the purpose of this is to provide a separate compilation space for Wasm code, which is used under the hood by the CLI whenever it builds your app to Wasm. The reason for this is so that we can build the engine and the browser sides in parallel. With only one <code>target/</code> directory, Cargo would make us wait until one had completed before starting the other, which slows down compilation. In testing, there tends to be a significant reduction in compilation times as a result of this separation of targets.</p>\\n<p>Finally, note that the Perseus CLI will automatically install the <code>wasm-bindgen</code> and <code>wasm-opt</code> CLIs in a system-wide cache (see <a href=\\"https://docs.rs/directories/latest/directories/struct.ProjectDirs.html#method.cache_dir\\">here</a> for how that's calculated), or in <code>dist/tools/</code> if that fails (there's an option to ensure the local cache is used as well, which you might want to set for more reproducible builds).</p>\\n","current_version":"next","manifest":{"0.1.x":{"docs_rs":"0.1","git":"v0.1.4","state":"outdated"},"0.2.x":{"docs_rs":"0.2","git":"v0.2.3","state":"outdated"},"0.3.0-0.3.3":{"docs_rs":"0.3.3","git":"v0.3.3","state":"outdated"},"0.3.4":{"docs_rs":"0.3","git":"v0.3.6","state":"outdated"},"0.4.x":{"docs_rs":"0.4","git":"HEAD","state":"stable"}},"sidebar_content":"<h1>Introduction</h1>\\n<ul>\\n<li><a href=\\"https://framesurge.sh/perseus/en-US/docs/next/intro\\">Introduction</a></li>\\n<li><a href=\\"https://framesurge.sh/perseus/en-US/docs/next/quickstart\\">Quickstart</a></li>\\n<li><a href=\\"https://framesurge.sh/perseus/en-US/docs/next/what-is-perseus\\">What is Perseus?</a></li>\\n<li><a href=\\"https://framesurge.sh/perseus/en-US/docs/next/core-principles\\">Core Principles</a></li>\\n</ul>\\n<h1>Your First App</h1>\\n<ul>\\n<li><a href=\\"https://framesurge.sh/perseus/en-US/docs/next/first-app/installation\\">Installing Perseus</a></li>\\n<li><a href=\\"https://framesurge.sh/perseus/en-US/docs/next/first-app/defining\\">Defining your app</a></li>\\n<li><a href=\\"https://framesurge.sh/perseus/en-US/docs/next/first-app/generating-pages\\">Generating pages</a></li>\\n<li><a href=\\"https://framesurge.sh/perseus/en-US/docs/next/first-app/dev-cycle\\">Development cycle</a></li>\\n<li><a href=\\"https://framesurge.sh/perseus/en-US/docs/next/first-app/error-handling\\">Error handling</a></li>\\n<li><a href=\\"https://framesurge.sh/perseus/en-US/docs/next/first-app/deploying\\">Deploying your app</a></li>\\n</ul>\\n<h1>Fundamentals</h1>\\n<ul>\\n<li><a href=\\"https://framesurge.sh/perseus/en-US/docs/next/fundamentals/perseus-app\\"><code>PerseusApp</code></a></li>\\n<li><a href=\\"https://framesurge.sh/perseus/en-US/docs/next/fundamentals/reactor\\">The reactor</a></li>\\n<li><a href=\\"https://framesurge.sh/perseus/en-US/docs/next/fundamentals/routing\\">Routing and navigation</a>\\n<ul>\\n<li><a href=\\"https://framesurge.sh/perseus/en-US/docs/next/fundamentals/preloading\\">Preloading</a></li>\\n</ul>\\n</li>\\n<li><a href=\\"https://framesurge.sh/perseus/en-US/docs/next/fundamentals/i18n\\">Internationalization</a></li>\\n<li><a href=\\"https://framesurge.sh/perseus/en-US/docs/next/fundamentals/error-views\\">Error views</a></li>\\n<li><a href=\\"https://framesurge.sh/perseus/en-US/docs/next/fundamentals/hydration\\">Hydration</a></li>\\n<li><a href=\\"https://framesurge.sh/perseus/en-US/docs/next/fundamentals/static-content\\">Static content</a></li>\\n<li><a href=\\"https://framesurge.sh/perseus/en-US/docs/next/fundamentals/head-headers\\">Heads and headers</a></li>\\n<li><a href=\\"https://framesurge.sh/perseus/en-US/docs/next/fundamentals/styling\\">Styling</a></li>\\n<li><a href=\\"https://framesurge.sh/perseus/en-US/docs/next/fundamentals/js-interop\\">Working with JS</a></li>\\n<li><a href=\\"https://framesurge.sh/perseus/en-US/docs/next/fundamentals/serving-exporting\\">Servers and exporting</a></li>\\n<li><a href=\\"https://framesurge.sh/perseus/en-US/docs/next/fundamentals/debugging\\">Debugging</a></li>\\n<li><a href=\\"https://framesurge.sh/perseus/en-US/docs/next/fundamentals/testing\\">Writing tests</a></li>\\n<li><a href=\\"https://framesurge.sh/perseus/en-US/docs/next/fundamentals/plugins\\">Plugins</a></li>\\n<li><a href=\\"https://framesurge.sh/perseus/en-US/docs/next/fundamentals/compilation-times\\">Improving Compilation Times</a></li>\\n</ul>\\n<h1>The State Platform</h1>\\n<ul>\\n<li><a href=\\"https://framesurge.sh/perseus/en-US/docs/next/state/intro\\">Understanding state</a></li>\\n<li><a href=\\"https://framesurge.sh/perseus/en-US/docs/next/state/build\\">Build-time state</a></li>\\n<li><a href=\\"https://framesurge.sh/perseus/en-US/docs/next/state/request\\">Request-time state</a></li>\\n<li><a href=\\"https://framesurge.sh/perseus/en-US/docs/next/state/revalidation\\">Revalidation</a></li>\\n<li><a href=\\"https://framesurge.sh/perseus/en-US/docs/next/state/incremental\\">Incremental generation</a></li>\\n<li><a href=\\"https://framesurge.sh/perseus/en-US/docs/next/state/amalgamation\\">State amalgamation</a></li>\\n<li><a href=\\"https://framesurge.sh/perseus/en-US/docs/next/state/browser\\">Using state</a></li>\\n<li><a href=\\"https://framesurge.sh/perseus/en-US/docs/next/state/global\\">Global state</a></li>\\n<li><a href=\\"https://framesurge.sh/perseus/en-US/docs/next/state/helper\\">Helper state</a></li>\\n<li><a href=\\"https://framesurge.sh/perseus/en-US/docs/next/state/suspense\\">Suspended state</a></li>\\n<li><a href=\\"https://framesurge.sh/perseus/en-US/docs/next/state/freezing-thawing\\">Freezing and thawing</a></li>\\n<li><a href=\\"https://framesurge.sh/perseus/en-US/docs/next/state/manual\\">Manually implementing <code>ReactiveState</code></a></li>\\n</ul>\\n<h1>Capsules</h1>\\n<ul>\\n<li><a href=\\"https://framesurge.sh/perseus/en-US/docs/next/capsules/intro\\">Introduction</a></li>\\n<li><a href=\\"https://framesurge.sh/perseus/en-US/docs/next/capsules/using\\">Using capsules</a></li>\\n<li><a href=\\"https://framesurge.sh/perseus/en-US/docs/next/capsules/capsules-vs-components\\">Capsules vs. components</a></li>\\n</ul>\\n<h1>Miscellaneous</h1>\\n<ul>\\n<li><a href=\\"https://framesurge.sh/perseus/en-US/docs/next/migrating\\">Migrating from v0.3.x</a></li>\\n<li><a href=\\"https://framesurge.sh/perseus/en-US/docs/next/faq\\">Common pitfalls and FAQs</a></li>\\n</ul>\\n","status":"Next","title":"Core Principles"}`;
window.__PERSEUS_INITIAL_WIDGET_STATES = `{}`;
window.__PERSEUS_TRANSLATIONS = `{
    "perseus": "Perseus",
    "sycamore": "Sycamore",
    "navlinks.docs": "Docs",
    "navlinks.comparisons": "Comparisons",
    "navlinks.plugins": "Plugins",
    "index-intro.heading": "The Rust framework for the modern web",
    "index-intro.get-started-button": "Get started now",
    "index-intro.github-button": "GitHub",
    "index-state-gen.heading": "Generate state, on your terms",
    "index-state-gen.desc": "Perseus apps can generate state whenever they like and pass it to <a href=\\"https://github.com/sycamore-rs/sycamore\\" class=\\"underline\\">Sycamore</a>, one of the fastest web frameworks in the world.",
    "index-i18n.heading.start": "I18n",
    "index-i18n.heading.rest": " that just works",
    "index-i18n.heading.tooltip": "Internationalization",
    "index-i18n.desc": "Just add translations using <a href=\\"https://projectfluent.org\\" class=\\"underline\\">Fluent</a>, and your app can be set up in seconds in multiple languages, with automatic user locale detection.",
    "index-opts.heading": "You want options? We got options.",
    "index-opts.desc": "Perseus comes with a built-in plugins system and full customizability of almost every part of the system. Static exporting? Serverful deployment? Fetch data by carrier pigeon? Easy.",
    "index-speed.heading": "Fast. Crazy. Fast.",
    "index-speed.desc-line-1": "Underlying platform? <strong>Rust.</strong>",
    "index-speed.desc-line-2": "Target platform? <strong>WebAssembly.</strong>",
    "index-speed.desc-line-3": "Lighthouse scores? <strong>💯</strong>",
    "index-speed.desktop-perf-label": "Performance (Desktop)",
    "index-speed.mobile-perf-label": "Performance (Mobile)",
    "index-speed.best-practices-label": "Best Practices",
    "index-cta.heading": "Get started with Perseus today!",
    "index-cta.docs-button": "Docs",
    "index-cta.gh-button": "GitHub",
    "index-cta.api-docs-button": "API Docs",
    "index-cta.crates-io-button": "Crates.io",
    "index-cta.matrix-button": "Matrix",
    "index-cta.discord-button": "Discord",
    "index-cta.comparisons-button": "Comparisons",
    "footer.copyright": "© <a href=\\"https://github.com/arctic-hen7\\" class=\\"underline\\">arctic-hen7</a> { $years }, see license <a href=\\"https://github.com/framesurge/perseus/blob/main/LICENSE\\" class=\\"underline\\">here</a>.",
    "comparisons-title": "Comparisons to Other Frameworks",
    "comparisons-heading": "Comparisons",
    "comparisons-subtitle": "See how Perseus compares to other web development frameworks.",
    "comparisons-extra": "Is there anything we're missing here? Please <a href =\\"https://github.com/framesurge/perseus/issues/new/choose\\" class=\\"underline\\">open an issue</a> and let us know!",
    "comparisons-table-header": "Comparison",
    "comparisons-table-headings.name": "Name",
    "comparisons-table-headings.supports_ssg": "Static generation",
    "comparisons-table-headings.supports_ssr": "Server-side rendering",
    "comparisons-table-headings.supports_ssr_ssg_same_page": "SSG & SSR in same page",
    "comparisons-table-headings.supports_i18n": "Internationalization",
    "comparisons-table-headings.supports_incremental": "Incremental generation",
    "comparisons-table-headings.supports_revalidation": "Revalidation",
    "comparisons-table-headings.inbuilt_cli": "Inbuilt CLI",
    "comparisons-table-headings.inbuilt_routing": "Routing support",
    "comparisons-table-headings.supports_shell": "App shell",
    "comparisons-table-headings.supports_deployment": "Easy deployment",
    "comparisons-table-headings.supports_exporting": "Static exporting",
    "comparisons-table-headings.language": "Language",
    "comparisons-table-headings.homepage_lighthouse_desktop": "Homepage Lighthouse Score (Desktop)",
    "comparisons-table-headings.homepage_lighthouse_mobile": "Homepage Lighthouse Score (Mobile)",
    "comparisons-table-details.supports_ssg": "Whether or not the framework supports pre-rendering pages at build-time.",
    "comparisons-table-details.supports_ssr": "Whether or not the framework supports rendering pages dynamically when they're requested.",
    "comparisons-table-details.supports_ssr_ssg_same_page": "Whether or not the framework supports SSG and SSR (see above) in the very same page.",
    "comparisons-table-details.supports_i18n": "Whether or not the framework supports building a multilingual app. Some frameworks support this through plugins.",
    "comparisons-table-details.supports_incremental": "Whether or not the framework supports rendering pages on-demand and then caching them for future use.",
    "comparisons-table-details.supports_revalidation": "Whether or not the framework supports rebuilding pages that were built at build-time at request-time. Some frameworks can do this by time, or by custom logic. Perseus supports both.",
    "comparisons-table-details.inbuilt_cli": "Whether or not the framework has a command-line interface for convenient usage. Some frameworks use third-party CLIs.",
    "comparisons-table-details.inbuilt_routing": "Whether or not the framework supports inbuilt routing. Most frameworks have their own way of doing this if they do support it.",
    "comparisons-table-details.supports_shell": "Whether or not this framework has an app shell, which makes switching pages much faster and cleaner.",
    "comparisons-table-details.supports_deployment": "Whether or not this framework supports easy deployment. Perseus can deploy in one command.",
    "comparisons-table-details.supports_exporting": "Whether or not this framework can operate without a server, as a series of purely static files.",
    "comparisons-table-details.language": "The programming language this framework is built in. (Hint: Rust is the fastest!)",
    "comparisons-table-details.homepage_lighthouse_desktop": "The Lighthouse score out of 100 for desktop (higher is better). These are collected from Google's PageSpeed Insights tool. These are for the framework's website, and may not reflect the performance of all sites made with the framework.",
    "comparisons-table-details.homepage_lighthouse_mobile": "The Lighthouse score out of 100 for mobile (higher is better). These are collected from Google's PageSpeed Insights tool. These are for the framework's website, and may not reflect the performance of all sites made with the framework.",
    "comparisons-sycamore-heading": "Perseus vs Sycamore",
    "comparisons-sycamore-text": "Perseus is a framework that uses Sycamore to write views (the things users see), so there's not much point in comparing the two as competitors. However, Sycamore can be used without Perseus, which works perfectly well, though you'll miss out on features like inbuilt internationalization, static generation (though you could build this yourself), and incremental generation. If you want to build just a bit of your site with Rust, Sycamore is the perfect tool, Perseus is a full framework designed for building entire websites.",
    "comparisons-unknown-heading": "Perseus vs { $name }",
    "docs-title-base": "Perseus Docs",
    "docs-status.outdated": "This version of the documentation is outdated, and features documented here may work differently now. You can see the latest stable version of the docs <a href=\\"en-US/docs/{ $stable }/intro\\" class=\\"underline\\">here</a>.",
    "docs-status.beta": "This version of the documentation is for a version that has only been released in beta, and is not yet stable. Features documented here may not be present in the latest stable version, and they're subject to rapid and drastic change. You can see the latest stable version of the docs <a href=\\"en-US/docs/{ $stable }/intro\\" class=\\"underline\\">here</a>.",
    "docs-status.next": "This version of the documentation is for a version that has not yet been released, and features documented here may not be present in the latest release. You can see the latest stable version of the docs <a href=\\"en-US/docs/{ $stable }/intro\\" class=\\"underline\\">here</a>.",
    "docs-version-switcher.next": "Next (unreleased)",
    "docs-version-switcher.beta": "v{ $version } (beta)",
    "docs-version-switcher.stable": "v{ $version } (stable)",
    "docs-version-switcher.outdated": "v{ $version } (outdated)",
    "plugins-title": "Plugins",
    "plugins-title-full": "Perseus Plugins",
    "plugin-card-author": "By { $author }",
    "plugin-details.repo_link": "Repository:",
    "plugin-details.crates_link": "Crate page:",
    "plugin-details.docs_link": "Docs:",
    "plugin-details.site_link": "Site:",
    "plugin-details.metadata_heading": "Metadata",
    "plugin-details.no_link_text": "N/A",
    "plugin-search.placeholder": "Search",
    "plugin-search.no_results": "No results found.",
    "plugins-desc": "These are all the public plugins for Perseus! If you've made a plugin, and you'd like it to be listed here, please open an issue on our repository!",
    "search": "Search the docs",
    "index-example-switcher.excerpts": "Excerpts",
    "index-example-switcher.full": "Full"
}
`;</script><meta itemprop=__perseus_head_end><script>//</script><body class="bg-white dark:bg-neutral-900"><div id=root><header data-hk=8.0 class="shadow-md sm:p-2 w-full mb-20 bg-neutral-500/30 backdrop-blur-lg text-black dark:text-white"><div data-hk=8.1 class="flex justify-between items-center"><a data-hk=8.2 class="justify-self-start self-center m-3 ml-5 text-md sm:text-2xl text-bold title-font"href=en-US/>Perseus</a><div data-hk=8.3 class="md:hidden m-3 mr-5 tham tham-e-spin tham-w-6"><div data-hk=8.4 class=tham-box><div data-hk=8.5 class="tham-inner bg-black dark:bg-white"></div></div></div><nav data-hk=8.6 class="hidden md:flex"><ul data-hk=8.7 class="mr-5 flex"><li data-hk=9.0 class="m-3 p-1 title-font"><a data-hk=9.1 href=en-US/docs class=px-2>Docs</a><li data-hk=9.2 class="m-3 p-1 title-font"><a data-hk=9.3 href=en-US/comparisons class=px-2>Comparisons</a><li data-hk=9.4 class="m-3 p-1 title-font"><a data-hk=9.5 href=en-US/plugins class=px-2>Plugins</a></ul></nav></div><nav data-hk=8.8 id=mobile_nav_menu class="md:hidden w-full text-center justify-center hidden"><ul data-hk=8.9 class=mr-5><li data-hk=10.0 class="m-3 p-1 title-font"><a data-hk=10.1 href=en-US/docs class=px-2>Docs</a><li data-hk=10.2 class="m-3 p-1 title-font"><a data-hk=10.3 href=en-US/comparisons class=px-2>Comparisons</a><li data-hk=10.4 class="m-3 p-1 title-font"><a data-hk=10.5 href=en-US/plugins class=px-2>Plugins</a></ul><hr data-hk=2.0><div data-hk=2.1 class="text-left p-3 overflow-y-scroll h-[60vh]"><div data-hk=2.2 class="flex w-full justify-center text-center"><div data-hk=2.3 class="max-w-3xl flex flex-col"><select data-hk=4.4 class="p-2 rounded-md text-white bg-indigo-500"><option data-hk=4.5 value=next selected>Next (unreleased)<option data-hk=4.6 value=0.4.x>v0.4.x (stable)<option data-hk=4.0 value=0.3.4>v0.3.4 (outdated)<option data-hk=4.1 value=0.3.0-0.3.3>v0.3.0-0.3.3 (outdated)<option data-hk=4.2 value=0.2.x>v0.2.x (outdated)<option data-hk=4.3 value=0.1.x>v0.1.x (outdated)</select></div></div><div data-hk=2.4 class=docs-links-markdown><h1>Introduction</h1><ul><li><a href=https://framesurge.sh/perseus/en-US/docs/next/intro>Introduction</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/quickstart>Quickstart</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/what-is-perseus>What is Perseus?</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/core-principles>Core Principles</a></ul><h1>Your First App</h1><ul><li><a href=https://framesurge.sh/perseus/en-US/docs/next/first-app/installation>Installing Perseus</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/first-app/defining>Defining your app</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/first-app/generating-pages>Generating pages</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/first-app/dev-cycle>Development cycle</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/first-app/error-handling>Error handling</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/first-app/deploying>Deploying your app</a></ul><h1>Fundamentals</h1><ul><li><a href=https://framesurge.sh/perseus/en-US/docs/next/fundamentals/perseus-app><code>PerseusApp</code></a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/fundamentals/reactor>The reactor</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/fundamentals/routing>Routing and navigation</a> <ul><li><a href=https://framesurge.sh/perseus/en-US/docs/next/fundamentals/preloading>Preloading</a></ul><li><a href=https://framesurge.sh/perseus/en-US/docs/next/fundamentals/i18n>Internationalization</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/fundamentals/error-views>Error views</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/fundamentals/hydration>Hydration</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/fundamentals/static-content>Static content</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/fundamentals/head-headers>Heads and headers</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/fundamentals/styling>Styling</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/fundamentals/js-interop>Working with JS</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/fundamentals/serving-exporting>Servers and exporting</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/fundamentals/debugging>Debugging</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/fundamentals/testing>Writing tests</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/fundamentals/plugins>Plugins</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/fundamentals/compilation-times>Improving Compilation Times</a></ul><h1>The State Platform</h1><ul><li><a href=https://framesurge.sh/perseus/en-US/docs/next/state/intro>Understanding state</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/state/build>Build-time state</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/state/request>Request-time state</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/state/revalidation>Revalidation</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/state/incremental>Incremental generation</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/state/amalgamation>State amalgamation</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/state/browser>Using state</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/state/global>Global state</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/state/helper>Helper state</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/state/suspense>Suspended state</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/state/freezing-thawing>Freezing and thawing</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/state/manual>Manually implementing <code>ReactiveState</code></a></ul><h1>Capsules</h1><ul><li><a href=https://framesurge.sh/perseus/en-US/docs/next/capsules/intro>Introduction</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/capsules/using>Using capsules</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/capsules/capsules-vs-components>Capsules vs. components</a></ul><h1>Miscellaneous</h1><ul><li><a href=https://framesurge.sh/perseus/en-US/docs/next/migrating>Migrating from v0.3.x</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/faq>Common pitfalls and FAQs</a></ul></div></div></nav></header><main data-hk=2.20 id=scroll-container><div data-hk=2.5 class="flex w-full"><div data-hk=2.6 class="h-screen pt-14 xs:pt-16 sm:pt-20 lg:pt-25 hidden md:block max-w-xs w-full border-r overflow-y-auto"><div data-hk=2.7 class=mr-5><div data-hk=2.8 class="text-left text-black dark:text-white p-3"><aside data-hk=2.9><div data-hk=2.10 class="flex flex-col"><select data-hk=6.4 class="p-2 rounded-md text-white bg-indigo-500"><option data-hk=6.5 value=next selected>Next (unreleased)<option data-hk=6.6 value=0.4.x>v0.4.x (stable)<option data-hk=6.0 value=0.3.4>v0.3.4 (outdated)<option data-hk=6.1 value=0.3.0-0.3.3>v0.3.0-0.3.3 (outdated)<option data-hk=6.2 value=0.2.x>v0.2.x (outdated)<option data-hk=6.3 value=0.1.x>v0.1.x (outdated)</select></div><div data-hk=2.11 class=docs-links-markdown><h1>Introduction</h1><ul><li><a href=https://framesurge.sh/perseus/en-US/docs/next/intro>Introduction</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/quickstart>Quickstart</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/what-is-perseus>What is Perseus?</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/core-principles>Core Principles</a></ul><h1>Your First App</h1><ul><li><a href=https://framesurge.sh/perseus/en-US/docs/next/first-app/installation>Installing Perseus</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/first-app/defining>Defining your app</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/first-app/generating-pages>Generating pages</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/first-app/dev-cycle>Development cycle</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/first-app/error-handling>Error handling</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/first-app/deploying>Deploying your app</a></ul><h1>Fundamentals</h1><ul><li><a href=https://framesurge.sh/perseus/en-US/docs/next/fundamentals/perseus-app><code>PerseusApp</code></a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/fundamentals/reactor>The reactor</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/fundamentals/routing>Routing and navigation</a> <ul><li><a href=https://framesurge.sh/perseus/en-US/docs/next/fundamentals/preloading>Preloading</a></ul><li><a href=https://framesurge.sh/perseus/en-US/docs/next/fundamentals/i18n>Internationalization</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/fundamentals/error-views>Error views</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/fundamentals/hydration>Hydration</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/fundamentals/static-content>Static content</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/fundamentals/head-headers>Heads and headers</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/fundamentals/styling>Styling</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/fundamentals/js-interop>Working with JS</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/fundamentals/serving-exporting>Servers and exporting</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/fundamentals/debugging>Debugging</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/fundamentals/testing>Writing tests</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/fundamentals/plugins>Plugins</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/fundamentals/compilation-times>Improving Compilation Times</a></ul><h1>The State Platform</h1><ul><li><a href=https://framesurge.sh/perseus/en-US/docs/next/state/intro>Understanding state</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/state/build>Build-time state</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/state/request>Request-time state</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/state/revalidation>Revalidation</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/state/incremental>Incremental generation</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/state/amalgamation>State amalgamation</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/state/browser>Using state</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/state/global>Global state</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/state/helper>Helper state</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/state/suspense>Suspended state</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/state/freezing-thawing>Freezing and thawing</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/state/manual>Manually implementing <code>ReactiveState</code></a></ul><h1>Capsules</h1><ul><li><a href=https://framesurge.sh/perseus/en-US/docs/next/capsules/intro>Introduction</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/capsules/using>Using capsules</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/capsules/capsules-vs-components>Capsules vs. components</a></ul><h1>Miscellaneous</h1><ul><li><a href=https://framesurge.sh/perseus/en-US/docs/next/migrating>Migrating from v0.3.x</a><li><a href=https://framesurge.sh/perseus/en-US/docs/next/faq>Common pitfalls and FAQs</a></ul></div></aside></div></div></div><div data-hk=2.12 class="h-screen pt-14 xs:pt-16 sm:pt-20 lg:pt-25 grid grid-rows-[1fr_min-content] w-full overflow-y-auto"><div data-hk=2.13 class="px-3 w-full sm:mr-auto sm:ml-auto sm:max-w-prose lg:max-w-3xl xl:max-w-4xl 2xl:max-w-5xl min-w-0"><div data-hk=2.14 class="ring-4 ring-orange-400 p-4 rounded-lg mt-1"><div data-hk=2.15 class="flex flex-col 2xs:flex-row dark:text-white"><span data-hk=2.16 class="self-center mr-2"style="fill: #fb923c;"><svg xmlns=http://www.w3.org/2000/svg height=auto viewbox="0 0 24 24"width=2.25rem fill=\#000000><path d="M12 7c.55 0 1 .45 1 1v4c0 .55-.45 1-1 1s-1-.45-1-1V8c0-.55.45-1 1-1zm-.01-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm1-3h-2v-2h2v2z"/></svg></span><p data-hk=2.17>This version of the documentation is for a version that has not yet been released, and features documented here may not be present in the latest release. You can see the latest stable version of the docs <a href=en-US/docs/0.4.x/intro class=underline>here</a>.</div></div><main data-hk=2.18 class="text-black dark:text-white"><div data-hk=1.0 class="markdown min-w-0 pb-10"><h1>Core Principles</h1><p>Before you dive into Perseus, you might want to get a better idea of the fundamentals on which the framework is built. If you'd prefer to dive straight in though, check out <a href=https://framesurge.sh/perseus/en-US/docs/next/first-app/installation>the tutorial</a>, and then maybe come back here later.<p>The main key idea that underpins Perseus is about <em>templates</em>, and the primary architectural matter to understand is how Perseus apps actually work in terms of their components.<h2>Templates</h2><p>Templates are the key to understanding Perseus code. Once you do, you should be able to confidently write clear code for apps that do exactly what you want them to. Nicely, this core concept also correlates with the file of code that defines the majority of the inner workings of Perseus (which is 600 lines long...).<p>There are two things you need to know about templates:<ol><li>An app is split into templates, and each template is split into pages.<li>A page is generated from a template and state. <strong>Template + state = page</strong></ol><p>Anyone who's ever used a website before will be at least passingly familiar with the idea of <em>pages</em> --- they're things that display different content, each at a different route. For example, you might have a landing page at <code>https://example.com</code> and an about page at <code>https://example.com/about</code>.<p>In Perseus, pages are never coded directly, they're generated by the engine from templates. Templates can be thought of as mathematical functions if you like: (crudely) a template <code>T</code> can be defined such that <code>T(x) = P</code>, where <code>x</code> is some state, and <code>P</code> is a page.<p>Let's take an example to understand how this works in practice. Let's say you're building a music player app that has a vast library of songs (we'll ignore playlists, artists, etc. to keep things simple). The first step in designing your app is thinking about its structure. It comes fairly quickly that you'll need an index page to show the top songs, an about page to tell people about the platform, and one page for each song. Now, the index and about pages have different structures, but every song page has the same structure, just with different content. This is where templates come in. You would have one template for the index page and another for the about page, and then you'd have a third template for the songs pages.<p>That third template can take in some state, and produce a different page for every single song, but all with the same structure. You can see this kind of concept in action on this very website. Every page in the docs has the same heading up the top, footer down the bottom, and sidebar on the left (or in a menu if you're on mobile), but they all have different content. There's just one template involved for all this, which generates hundreds of pages (here, that same template generates pages for every version of Perseus ever).<p>So what about those first two? Well, they're very simple templates that don't take any state at all --- they can only produce one page. To take our crude mathematical definition, <code>T() = P</code> for these, and, since <code>T</code> takes no arguments, it can only produce the same page every time.<p>This illustrates nicely that the determining factor that differentiates pages from each other is state, and that's what Perseus is built around.<p>Let's return to our music player app. Are all those songs listed in a database available at build-time? Use the <a href=https://framesurge.sh/perseus/en-US/docs/next/state/build><em>build state</em></a> strategy. Are there too many to build all at once? Use <a href=https://framesurge.sh/perseus/en-US/docs/next/state/incremental><em>incremental generation</em></a> to build only the most commonly used songs first, and then build the rest on-demand when they're first accessed, caching to make them fast for subsequent users.<p>Once that state is generated, Perseus will go right ahead and proactively prerender your pages to HTML, meaning your users see content the second they load your site. (This is called server-side rendering, except the actual rendering has happened ahead of time, whenever you built your app.)<p>These ideas are built into Perseus at the core, and generating state for templates to generate pages is the fundamental idea behind Perseus. You'll find similar concepts in popular JavaScript frameworks like NextJS and GatsbyJS. It's Perseus' speed, ergonomics, and some things we'll explain in a moment that set it apart.<p>Once you've generated some state and you've got all the pages ready, there's still a log of work to be done on this music player app. A given song might be paused or playing, the user might have manually turned off dark mode, autoplaying related songs might be on or off. This is all state, but it's not state that we can handle when we build your app. Traditionally, frameworks would leave you on your own here to work this all out, but Perseus tries to be a little more helpful by <em>automatically making your state reactive</em>. Let's say the state for a single song page includes the properties <code>name</code>, <code>artist</code>, <code>album</code>, <code>year</code>, and <code>paused</code> (there'd probably be a lot more in reality though!). The first four can be set at build time and forgotten about, but <code>paused</code> could be changed at any time. No problem, you can change it once the page is loaded. Just call <code>.set()</code> on it and Perseus will not only update it locally, but it will update it in a store global to your app so that, if a user goes back to that song later, it will be preserved (or not, your choice). And what about things like <code>dark_mode</code>, state that's relevant to the whole app? Well, Perseus provides inbuilt support for reactive global state that can be interacted with from any page.<p>Now, if you're familiar with user interface (UI) development, this might all sound familiar to you, it's very similar to the <em>MVC</em>, or <em>model, view, controller</em> pattern. If you've never heard of this, it's just a way of developing apps in which you hold all the states that your app can possibly be in in a <em>model</em> and use that to build a <em>view</em>. Then you handle user interaction with a <em>controller</em>, which modifies the state, and the <em>view</em> updates accordingly. Perseus doesn't force this structure on you, and in fact you can opt out entirely from all this reactive state business if it's not your cup of tea with no problems, because Perseus doesn't use MVC as a <em>pattern</em> that you develop in, it uses it as an <em>architecture</em> that your code works in. You can use development patterns from 1960 or 2060 if you want, Perseus doesn't mind, it'll just work away in the background and make sure your app's state <em>just works</em>.<p>Perseus also adds a little twist to the usual ideas of app state. If your entire app is represented in its state, then wouldn't it be cool if you could <em>freeze</em> that state, save it somewhere, and then boot it back up later to bring your app to exactly where it was before? This is inbuilt into Perseus, and it's still insanely fast. But, if you don't want it, you can turn it off, no problem.<p>THis does let you do some really cool stuff though, like bringing a user back to exactly where they left off when they log back into your app, down to the last character they typed into an input, with only a few lines of code. (You store a string, Perseus handles the freezing and thawing.)<h2>Architecture</h2><p>When you write a Perseus app, you'll usually just define a <code>main()</code> function annotated with <code>#[perseus::main(...)]</code>, but this does some important things in the background. Specifically, it actually creates three functions: one that returns your <code>PerseusApp</code>, and then two new <code>main()</code> functions: one for the engine, and another for the browser. That distinction is one you should get used to, because it pervades Perseus. Unfortunately, most other frameworks try to shove this away behind some abstractions, which leads to confusing dynamics about where a function should actually be run. Perseus tries to make this as clear as possible.<p>Before we can go any further into this though, we'll need to define the <em>engine</em>, because it's a Perseus-specific term. Usually, people would refer to the server-side, but this term was avoided for Perseus to make clear that the server is just a single part of the engine. The engine is made up of these components:<ul><li>Builder --- builds your app, generating some stuff in <code>dist/</code><li>Exporter --- goes a few steps further than the builder, structuring your app for serving as a flat file structure, with no explicit server<li>Server --- serves the built artifacts in <code>dist/</code>, executing certain server-side logic as necessary<li>Error page exporter --- exports a single error page to a static file (e.g. you'll need this if you want your custom error pages to work on GitHub Pages or similar hosts)<li>Tinker --- runs a certain type of plugin (more on this later)</ul><p>So, when we talk about <em>engine-side</em>, we mean this! The reason these are all lumped together is because they're all actually one binary, which is told what exact action to perform by a special environment variable automatically set by the CLI. So, when you run <code>perseus export</code> and <code>perseus serve</code>, those are actually <em>basically</em> both doing the exact same thing, just with a different environment variable setting!<p>As for the browser-side, this is just the code that runs on the <code>wasm32-unknown-unknown</code> target (yes, those <code>unknown</code>s are supposed to be there!), which is Rust's way of talking about the browser.<p>So, when we use the <code>#[perseus::main(...)]</code> macro, that's creating a function that returns your <code>PerseusApp</code>, and another called <code>main()</code> for the server (which is annotated with <code>#[tokio::main]</code> to make it asynchronous), and another called <code>main()</code> for the client (annotated with <code>#[wasm_bindgen::prelude::wasm_bindgen]</code> to make it discoverable by the browser).<p>What's nice about this architecture is that you can do it yourself without the macro! In fact, if you want to do more advanced things, like setting up custom API routes, this is the best way to go. Then, you would use the <code>#[perseus::engine_main]</code> and <code>#[perseus::browser_main]</code> annotations to make your life easier. (Or, you could avoid them and do their work yourself, which is very straightforward.)<p>The key thing here is that you can easily use this more advanced structure to gain greater control over your app, without sacrificing any performance. From here, you can also gain greater control over any part of your app's build process, which makes Perseus practically infinitely customizable to do exactly what you want!<p>The upshot of all this is that Perseus is actually creating two separate entrypoints, one for the engine-side, and another for the browser-side. Crucially, both use the same <code>PerseusApp</code>, which is a universal way of defining your app's components, like templates. (You don't need to know this, but it actually does slightly different things on the browser and engine-sides itself to optimize your app.)<p>Why do you need to know all this? Because it makes it much easier to understand how to expand your app's capabilities, and it demystifies those macros a bit. Also, it shows that you can actually avoid them entirely if you want to! (Sycamore also has a <a href=https://sycamore-rs.netlify.app/docs/basics/view#builder-syntax>builder API</a> that you can use to avoid their <code>view! { .. }</code> macro too, if you really want.)<p>One more thing to briefly note is about the <code>dist/target_wasm/</code> and <code>dist/target_engine/</code> directories. As you might have inferred, the purpose of this is to provide a separate compilation space for Wasm code, which is used under the hood by the CLI whenever it builds your app to Wasm. The reason for this is so that we can build the engine and the browser sides in parallel. With only one <code>target/</code> directory, Cargo would make us wait until one had completed before starting the other, which slows down compilation. In testing, there tends to be a significant reduction in compilation times as a result of this separation of targets.<p>Finally, note that the Perseus CLI will automatically install the <code>wasm-bindgen</code> and <code>wasm-opt</code> CLIs in a system-wide cache (see <a href=https://docs.rs/directories/latest/directories/struct.ProjectDirs.html#method.cache_dir>here</a> for how that's calculated), or in <code>dist/tools/</code> if that fails (there's an option to ensure the local cache is used as well, which you might want to set for more reproducible builds).</div></main></div><div data-hk=2.19 class=row-start-2><footer data-hk=7.0 class="w-full flex justify-center py-5 bg-black text-white"><p data-hk=7.1 class="mx-5 text-center"><span data-hk=7.2>© <a href=https://github.com/arctic-hen7 class=underline>arctic-hen7</a> 2021-2023, see license <a href=https://github.com/framesurge/perseus/blob/main/LICENSE class=underline>here</a>.</span></footer></div></div></div></main><script data-hk=0.0 src=.perseus/static/prism.js defer></script><script data-hk=0.1>window.Prism.highlightAll();</script></div><div id=__perseus_popup_error></div>